(this.webpackJsonpreact_dom=this.webpackJsonpreact_dom||[]).push([[0],{1202:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(7),c=a.n(o),s=a(16),i=a(17),l=a(19),u=a(18),m=a(20),p=a(138),d=a(118),h=(a(68),a(32)),f=(a(120),a(28)),g=(a(98),a(42)),v=(a(121),a(6)),b=a(14),y=a.n(b),E=(a(99),a(24)),k=a(29),O=a(251),w=a.n(O);function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"get";return new Promise((function(n){("get"===a?w.a.get(e,{params:t}):w.a.post(e,t)).then((function(e){n(e)}))}))}w.a.interceptors.response.use((function(e){return e.data}));var j=a(505),x=a.n(j),S=function(e){return C("/login",e,"post")},I=function(e){var t="http://wthrcdn.etouch.cn/weather_mini?city="+e;return new Promise((function(e){x()(t,{},(function(t,a){if(1e3===a.status){var n=a.data.forecast[0];e(n)}else 302===a.status?E.a.error("\u914d\u989d\u8d85\u9650"):E.a.error("\u975e\u6cd5\u7684\u57ce\u5e02\u540d")}))}))},N=function(e){return C("/category/add",e,"post")},_=function(e){return C("/product/add",e,"post")},A=function(e){return C("/role/add",e,"post")},F=function(e){return C("/user/add",e,"post")},U=function(e,t){return C("/home/comments/add",{username:e,comment:t},"post")},D=function(e){return C("/category/list",{parentId:e})},R=function(e,t){return C("/product/list",{page:e,pagesize:t})},T=function(e,t,a,n){return C("/product/search",{page:e,pagesize:t,searchtype:a,keyword:n})},M=function(e){return C("/category/info",{categoryId:e})},L=function(e){return C("/role/list",e)},P=function(e){return C("/user/list",e)},K=function(e){return C("/role/info",{roleId:e})},W=function(){return C("/home/comments")},q=function(e){return C("/category/update",e,"post")},V=function(e){return C("/product/update",e,"post")},z=function(e){return C("/role/update",e,"post")},B=function(e){return C("/user/update",e,"post")},J=function(e){return C("/image/delete",{name:e},"post")},H=function(e){return C("/category/remove",e,"post")},Y=function(e){return C("/product/remove",e,"post")},G=function(e){return C("/role/remove",{removerole:e},"post")},Q=function(e){return C("/user/remove",e,"post")},X=function(e){return C("/home/comments/delete",{_id:e},"post")},Z={saveUser:function(e){localStorage.setItem("userInfo",JSON.stringify(e))},getUser:function(){return JSON.parse(localStorage.getItem("userInfo")||"{}")},removeUser:function(){localStorage.removeItem("userInfo")}},$=(a(599),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(){var e=Object(k.a)(y.a.mark((function e(t,n){var r,o,c,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=8;break}return console.log("\u7528\u6237\u4fe1\u606f:",n),e.next=4,S(n);case 4:r=e.sent,console.log(r),o=r.msg,c=r.status,s=r.data,0===c?(E.a.success("".concat(o)),Z.saveUser(s),a.props.history.push("/admin/home")):E.a.error("".concat(o));case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement("div",{className:"login-form"},r.a.createElement("h2",{className:"login-title"},"REACT\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf"),r.a.createElement(f.a,null,r.a.createElement(f.a.Item,null,e("username",{rules:[{min:3,message:"?\u4f60\u597d\u77ed"},{max:12,message:"\u592a\u957f\u9876\u4e0d\u4f4f\u4e86!"},{required:!0,message:"\u5b81\u5fc5\u987b\u62e5\u6709\u59d3\u540d"}]})(r.a.createElement(g.a,{prefix:r.a.createElement(v.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}))),r.a.createElement(f.a.Item,null,e("password",{rules:[{required:!0,message:"\u5b81\u5fc5\u987b\u586b\u5bc6\u7801"}]})(r.a.createElement(g.a,{prefix:r.a.createElement(v.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"}))),r.a.createElement(f.a.Item,null,r.a.createElement(h.a,{type:"default",htmlType:"submit",className:"login-form-button",onClick:this.handleSubmit,block:!0},"\u767b\u5f55"))))}}]),t}(n.Component)),ee=f.a.create()($),te=(a(363),a(142)),ae=(a(680),a(144)),ne=[{title:"\u9996\u9875",key:"/admin/home",icon:"home",public:!0},{title:"\u5546\u54c1",key:"/admin/products",icon:"appstore",children:[{title:"\u5206\u7c7b\u7ba1\u7406",key:"/admin/category",icon:"bars"},{title:"\u5546\u54c1\u7ba1\u7406",key:"/admin/product",icon:"tool"}]},{title:"\u7528\u6237\u7ba1\u7406",key:"/admin/user",icon:"user"},{title:"\u89d2\u8272\u7ba1\u7406",key:"/admin/role",icon:"safety"},{title:"\u56fe\u5f62\u56fe\u8868",key:"/admin/charts",icon:"area-chart",children:[{title:"\u67f1\u5f62\u56fe",key:"/admin/charts/bar",icon:"bar-chart"},{title:"\u6298\u7ebf\u56fe",key:"/admin/charts/line",icon:"line-chart"},{title:"\u997c\u56fe",key:"/admin/charts/pie",icon:"pie-chart"}]}],re=te.a.Sider,oe=ae.a.SubMenu,ce=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={menus:[]},a.getRoleMenus=Object(k.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.user=Z.getUser(),!a.user.role_id){e.next=9;break}return e.next=4,K(a.user.role_id);case 4:t=e.sent,a.user.menus=t.data,a.setState({menus:a.getMenus(ne)}),e.next=10;break;case 9:a.setState({menus:a.getMenus(ne)});case 10:case"end":return e.stop()}}),e)}))),a.hasAuth=function(e){return!("admin"!==a.user.username&&!e.public&&!a.user.menus.includes(e.key))||!!e.children&&e.children.find((function(e){return a.user.menus.includes(e.key)}))},a.getMenus=function(e){var t=a.props.location.pathname;return e.map((function(e){if(a.hasAuth(e))return e.children?(e.children.filter((function(e){return t===e.key})).length&&(a.defaultOpenKeys=e.key),r.a.createElement(oe,{key:e.key,title:r.a.createElement("span",null,r.a.createElement(v.a,{type:e.icon}),r.a.createElement("span",null,e.title))},a.getMenus(e.children))):r.a.createElement(ae.a.Item,{key:e.key},r.a.createElement(p.b,{to:e.key},r.a.createElement(v.a,{type:e.icon}),r.a.createElement("span",null,e.title)))}))},a.onCollapse=function(e){a.setState({collapsed:e})},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getRoleMenus()}},{key:"render",value:function(){var e=this.props.location.pathname;return r.a.createElement(re,null,r.a.createElement(ae.a,{defaultSelectedKeys:e,defaultOpenKeys:[this.defaultOpenKeys],mode:"inline",theme:"dark"},this.state.menus))}}]),t}(n.Component),se=Object(d.g)(ce),ie=(a(170),a(65)),le=(a(692),a(693),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("button",Object.assign({},this.props,{className:"my-button"}))}}]),t}(n.Component)),ue=ie.a.confirm,me=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={currenTime:(new Date).toLocaleString(),weatherInfo:{},title:"",weatherCity:"\u82cf\u5dde",fengli:""},a.getCurrent=function(){a.timer=setInterval((function(){a.setState({currenTime:(new Date).toLocaleString()})}),1e3)},a.getWeather=Object(k.a)(y.a.mark((function e(){var t,n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.weatherCity,e.next=3,I(t);case 3:n=e.sent,r=(r=n.fengli).substr(10,2),a.setState({weatherInfo:n,fengli:r});case 7:case"end":return e.stop()}}),e)}))),a.getTitle=function(){var e=a.props.location.pathname,t="";return ne.forEach((function(a){if(e===a.key&&(t=a.title),a.children){var n=a.children.find((function(t){return e.includes(t.key)}));n&&(t=n.title)}})),t},a.loginOut=function(){ue({title:"\u786e\u5b9a\u9000\u51fa\u5417",onOk:function(){a.props.history.push("/login")},onCancel:function(){console.log("cancle")}})},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.user=Z.getUser(),this.getWeather(),this.getTitle()}},{key:"componentDidMount",value:function(){this.getCurrent()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"render",value:function(){var e=this.state,t=e.currenTime,a=e.weatherCity,n=e.fengli,o=this.state.weatherInfo,c=o.type,s=o.high,i=o.low,l=o.fengxiang;return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"header-top"},r.a.createElement("span",null,"\u6b22\u8fce,",this.user.username),r.a.createElement(le,{onClick:this.loginOut},"\u9000\u51fa")),r.a.createElement("div",{className:"header-bottom"},r.a.createElement("span",{className:"header-bottom-left"},this.getTitle()),r.a.createElement("div",{className:"header-bottom-right"},r.a.createElement("span",null,t),a,r.a.createElement("span",null,c),l,r.a.createElement("span",null,n),s,"`",i)))}}]),t}(n.Component),pe=Object(d.g)(me),de=a(512),he=a.n(de),fe=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this))).state={username:"",comment:""},a.UserChange=function(e){a.setState({username:e.target.value})},a.CommentChange=function(e){a.setState({comment:e.target.value})},a.AddComment=function(){var e=a.state.username,t=a.dom.current.value;a.props.AddComments(e,t),a.dom.current.value="",a.setState({username:""})},a.dom=r.a.createRef(),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.username;return r.a.createElement("div",{id:"left"},r.a.createElement("span",null,"\u4f60\u7684\u540d\u5b57:"),r.a.createElement("input",{type:"text",id:"commentusername",ref:this.user,value:e,onChange:this.UserChange}),r.a.createElement("br",null),r.a.createElement("span",null,"\u4f60\u7684\u8bc4\u8bba:"),r.a.createElement("textarea",{rows:"4",ref:this.dom,onChange:this.CommentChange}),r.a.createElement("br",null),r.a.createElement("button",{onClick:this.AddComment},"\u63d0\u4ea4\u8bc4\u8bba"))}}]),t}(n.Component),ge=(a(694),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleDelete=function(e){X(e),a.props.initComments()},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=Z.getUser(),a=this.props,n=a.username,o=a.comment,c=a._id,s="admin"===t.username?"block":"none";return r.a.createElement("li",null,r.a.createElement("button",{className:"delete",style:{display:s},onClick:function(){e.handleDelete(c)}},"\u5220\u9664\u8bc4\u8bba"),r.a.createElement("p",{className:"user"},r.a.createElement("span",null,n),":"),r.a.createElement("p",{className:"comments"},o))}}]),t}(n.Component)),ve=a(513),be=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.comments,a=e.initComments;return r.a.createElement("div",{className:"commentslist"},r.a.createElement(ve.Scrollbars,null,r.a.createElement("h4",{style:{display:void 0===t[0]?"block":"none"}},"\u6c42\u6c42\u4f60\u7559\u53e5\u8bdd\u5427"),r.a.createElement("ul",null,t.map((function(e,t){return r.a.createElement(ge,{key:t,username:e.username,comment:e.comment,_id:e._id,initComments:a})})))))}}]),t}(n.Component),ye=(a(708),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={comments:[]},a.initComments=Object(k.a)(y.a.mark((function e(){var t,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W();case 2:t=e.sent,(n=t.data)===[]?a.setState({comments:[]}):a.setState({comments:n.reverse()});case 5:case"end":return e.stop()}}),e)}))),a.AddComments=function(){var e=Object(k.a)(y.a.mark((function e(t,n){var r,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(t,n);case 2:r=e.sent,o=r.msg,0===r.status?a.initComments():E.a.error(o);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a.showsize=function(e,t,n,r){var o=a.refs.app.style;o.opacity=e,o.width="".concat(t,"%"),o.height="".concat(n,"%"),o.transform="rotate(".concat(r,"deg)")},a.handleshow=function(){var e=!0!==a.state.show;a.setState({show:e}),"1%"===a.refs.app.style.height?a.showsize(100,45,4,0):a.showsize(0,1,1,710)},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){var e=Object(k.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.initComments();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){he.a.subscribe("delete",this.DeleteComment),this.style=this.refs.app.style,this.handleshow()}},{key:"render",value:function(){var e=this.state.comments;return r.a.createElement("div",{id:"home"},r.a.createElement(h.a,{onClick:this.handleshow},"\u7559\u53e5\u8bdd\u518d\u8d70?"),r.a.createElement("div",{className:"app",ref:"app"},r.a.createElement("div",{className:"content"},r.a.createElement(fe,{AddComments:this.AddComments}),r.a.createElement(be,{comments:e,initComments:this.initComments}))))}}]),t}(n.Component)),Ee=(a(104),a(45)),ke=(a(237),a(115)),Oe=(a(206),a(63)),we=Oe.a.Option,Ce=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.categories;return r.a.createElement(f.a,null,r.a.createElement(f.a.Item,null,e("parentId",{initialValue:"0"})(r.a.createElement(Oe.a,null,r.a.createElement(we,{value:"0"},"\u4e00\u7ea7\u5206\u7c7b"),t.map((function(e){return r.a.createElement(we,{value:e._id,key:e._id},e.name)}))))),r.a.createElement(f.a.Item,null,e("categoryName",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}]})(r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}))))}}]),t}(n.Component),je=f.a.create({})(Ce),xe=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement(f.a,null,r.a.createElement(f.a.Item,null,e("categoryName",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}]})(r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}))))}}]),t}(n.Component),Se=f.a.create({})(xe),Ie="/uploads/",Ne=4,_e=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={addvisible:!1,updatevisible:!1,categories:[],loading:!0,parentId:"0",parentName:"",subCategorys:[],updateId:""},a.columns=[{title:"\u5206\u7c7b\u540d\u79f0",dataIndex:"name"},{title:"\u64cd\u4f5c",width:300,render:function(e){return"0"===a.state.parentId?r.a.createElement("span",null,r.a.createElement(le,{onClick:function(){return a.showupdate(e)}},"\u4fee\u6539\u5206\u7c7b\u540d"),r.a.createElement(le,{onClick:function(){return a.showSubCategory(e)}},"\u67e5\u770b\u5b50\u5206\u7c7b"),r.a.createElement(le,{onClick:function(){return a.removeCategory(e)}},"\u5220\u9664\u5206\u7c7b")):r.a.createElement("span",null,r.a.createElement(le,{onClick:function(){return a.showupdate(e)}},"\u4fee\u6539\u5206\u7c7b\u540d"),r.a.createElement(le,{onClick:function(){return a.removeCategory(e)}},"\u5220\u9664\u5206\u7c7b"),r.a.createElement(le,{onClick:a.showCategory},"\u8fd4\u56de\u4e0a\u7ea7"))}}],a.showAdd=function(e){a.category=e,console.log(a.category),a.setState({addvisible:!0})},a.setForm=function(e){a.form=e},a.addCategory=function(){a.form.validateFields(function(){var e=Object(k.a)(y.a.mark((function e(t,n){var r,o,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=8;break}return n._id=a.category._id,console.log(n),e.next=5,N(n);case 5:r=e.sent,o=r.status,c=r.msg,0===o?(n.parentId===a.state.parentId?a.getCategories():"0"===n.parentId&&a.getCategories("0"),a.setState({addvisible:!1}),E.a.success(c)):E.a.error(c);case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),a.form.resetFields()},a.handleCancel=function(e){console.log("cancel"),a.setState({addvisible:!1,updatevisible:!1}),a.form.resetFields()},a.showupdate=function(e){console.log("\u4fee\u6539\u5206\u7c7b"),console.log(e),a.category=e,a.setState({updatevisible:!0})},a.updateCategory=function(e){a.form.validateFields(function(){var e=Object(k.a)(y.a.mark((function e(t,n){var r,o,c,s,i,l,u;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=12;break}if(r=a.category,o=r._id,c=r.parentId,s=n.categoryName,n._id=o,void 0!==s){e.next=7;break}return E.a.error("\u4f60\u5356\u7a7a\u6c14\u5417\u5f1f\u5f1f"),e.abrupt("return");case 7:return e.next=9,q(n);case 9:i=e.sent,l=i.status,u=i.msg,0===l?(a.setState({updatevisible:!1,parentId:c}),E.a.success(u),a.getCategories()):E.a.error(u);case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),a.form.resetFields()},a.removeCategory=function(){var e=Object(k.a)(y.a.mark((function e(t){var n,r,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(t);case 2:n=e.sent,r=n.status,o=n.msg,0===r?a.getCategories():E.a.error(o);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getCategories=function(){var e=Object(k.a)(y.a.mark((function e(t){var n,r,o,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),t=t||a.state.parentId,e.next=4,D(t);case 4:n=e.sent,a.setState({loading:!1}),r=n.status,o=n.msg,c=n.data,0===r?"0"===t?a.setState({categories:c}):a.setState({subCategorys:c}):("0"===t?a.setState({categories:c}):a.setState({subCategorys:c}),E.a.error(o));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.showSubCategory=function(e){a.setState({parentId:e._id,parentName:e.name},(function(){a.getCategories()}))},a.showCategory=function(){a.setState({parentId:"0",parentName:"",subCategorys:[]},(function(){a.getCategories()}))},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getCategories()}},{key:"render",value:function(){var e=this.state,t=e.categories,a=e.loading,n=e.subCategorys,o=e.parentId,c=e.parentName,s="0"===o?"\u4e00\u7ea7\u5206\u7c7b":r.a.createElement("span",null,r.a.createElement(le,{onClick:this.showCategory},"\u4e00\u7ea7\u5206\u7c7b"),r.a.createElement(v.a,{type:"arrow-right"}),c),i=r.a.createElement(h.a,{type:"primary",onClick:this.showAdd},r.a.createElement(v.a,{type:"plus"}),r.a.createElement("span",null,"\u6dfb\u52a0\u5206\u7c7b"));return r.a.createElement(Ee.a,{title:s,extra:i,style:{width:"100%"}},r.a.createElement(ke.a,{dataSource:"0"===o?t:n,columns:this.columns,rowKey:"_id",loading:a,bordered:!0,pagination:{defaultPageSize:Ne}}),";",r.a.createElement(ie.a,{title:"\u8bf7\u6dfb\u52a0\u5206\u7c7b",visible:this.state.addvisible,onOk:this.addCategory,onCancel:this.handleCancel},r.a.createElement(je,{setForm:this.setForm,categories:t})),r.a.createElement(ie.a,{title:"\u4fee\u6539\u5206\u7c7b\u540d",visible:this.state.updatevisible,onOk:this.updateCategory,onCancel:this.handleCancel},r.a.createElement(Se,{setForm:this.setForm})))}}]),t}(n.Component),Ae=(a(756),a(523)),Fe=a(331),Ue=a(524),De=(a(1203),a(522));function Re(e){return new Promise((function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}}))}var Te=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).getImgs=function(){return a.state.fileList.map((function(e){return e.name}))},a.handleCancel=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(){var e=Object(k.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,Re(t.originFileObj);case 3:t.preview=e.sent;case 4:a.setState({previewImage:t.url||t.preview,previewVisible:!0});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(){var e=Object(k.a)(y.a.mark((function e(t){var n,r,o,c,s,i,l,u,m;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.file,r=t.fileList,"done"!==n.status){e.next=9;break}o=n.response,c=o.data,s=o.msg,i=r[r.length-1],E.a.success(s),i.name=c.name,i.url=c.url,e.next=15;break;case 9:if("removed"!==n.status){e.next=15;break}return e.next=12,J(n.name);case 12:l=e.sent,u=l.status,m=l.msg,0===u&&E.a.success(m);case 15:a.setState({fileList:r});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var n=a.props.imgs,r=[];return n&&(r=n.map((function(e,t){return{uid:-t,name:e,status:"done",url:Ie+e}}))),a.state={previewVisible:!1,previewImage:"",fileList:r},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state,t=e.previewVisible,a=e.previewImage,n=e.fileList,o=r.a.createElement("div",null,r.a.createElement(v.a,{type:"plus"}),r.a.createElement("div",{className:"ant-upload-text"},"Upload"));return r.a.createElement("div",{className:"clearfix"},r.a.createElement(De.a,{action:"/image/upload",listType:"picture-card",fileList:n,name:"image",accept:"image/*",onPreview:this.handlePreview,onChange:this.handleChange},n.length>=6?null:o),r.a.createElement(ie.a,{visible:t,footer:null,onCancel:this.handleCancel},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:a})))}}]),t}(n.Component),Me=a(518),Le=a(140),Pe=a(519),Ke=a.n(Pe),We=a(520),qe=a.n(We),Ve=(a(892),function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).onEditorStateChange=function(e){a.setState({editorState:e})},a.getdetails=function(){return Ke()(Object(Le.convertToRaw)(a.state.editorState.getCurrentContent()))};var n=a.props.details;if(n){var r=qe()(n),o=Le.ContentState.createFromBlockArray(r.contentBlocks),c=Le.EditorState.createWithContent(o);a.state={editorState:c}}else a.state={editorState:Le.EditorState.createEmpty()};return a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.editorState;return r.a.createElement(Me.Editor,{editorState:e,editorStyle:{border:"1px solid #1DA57A",paddingLeft:20,height:200},wrapperClassName:"demo-wrapper",editorClassName:"demo-editor",onEditorStateChange:this.onEditorStateChange})}}]),t}(n.Component)),ze=g.a.TextArea,Be=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={options:[]},a.getCategories=Object(k.a)(y.a.mark((function e(){var t,n,r,o,c,s,i,l,u;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("0");case 2:if(t=e.sent,n=t.status,r=t.data,o=a.product.pCategoryId,c=a.forisLeaf(r,!1),0!==n){e.next=19;break}if(!a.update||"0"===o){e.next=16;break}return s=c.find((function(e){return e.value===o})),i=c.findIndex((function(e){return e.value===s.value})),e.next=12,D(s.value);case 12:l=e.sent,u=l.data,0===l.status?s.children=a.forisLeaf(u,!1):s.isLeaf=!0,c[i]=s;case 16:a.setState({options:c}),e.next=20;break;case 19:E.a.error("\u83b7\u53d6\u5931\u8d25");case 20:case"end":return e.stop()}}),e)}))),a.forisLeaf=function(e,t){return e.map((function(e){return{value:e._id,label:e.name,isLeaf:t}}))},a.loadData=function(){var e=Object(k.a)(y.a.mark((function e(t){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t[0]).loading=!0,e.next=4,D(n.value);case 4:r=e.sent,n.loading=!1,setTimeout((function(){var e=r.data;0===r.status?(n.children=a.forisLeaf(e,!0),a.setState({options:Object(Ue.a)(a.state.options)})):n.isLeaf=!0}),100);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handlesubmit=function(e){e.preventDefault(),a.props.form.validateFieldsAndScroll(function(){var e=Object(k.a)(y.a.mark((function e(t,n){var r,o,c,s,i,l,u,m,p,d,h,f,g,v,b,k,O,w;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=21;break}if(r=a.imgs.current.getImgs(),o=a.details.current.getdetails(),c=n.name,s=n.desc,i=n.price,1===(l=n.category).length?(p=Object(Fe.a)(l,2),u=p[0],d=p[1],m=void 0===d?"0":d):(h=Object(Fe.a)(l,2),m=h[0],u=h[1]),f={name:c,desc:s,price:i,pCategoryId:m,categoryId:u,imgs:r,details:o},console.log("\u662f\u5426\u4fee\u6539",a.update),!a.update){e.next=16;break}return f._id=a.product._id,e.next=11,V(f);case 11:g=e.sent,v=g.status,b=g.msg,0===v?(E.a.success(b),a.props.history.push("/admin/product")):E.a.error(b),e.next=21;break;case 16:return e.next=18,_(f);case 18:k=e.sent,O=k.status,w=k.msg,0===O?(E.a.success(w),a.props.history.push("/admin/product")):E.a.error(w);case 21:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.imgs=r.a.createRef(),a.details=r.a.createRef(),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.props.location.state?(this.update=!0,this.product=this.props.location.state.product):(this.update=!1,this.product={})}},{key:"componentDidMount",value:function(){this.getCategories()}},{key:"render",value:function(){var e=this.product,t=e.categoryId,a=e.desc,n=e.details,o=e.imgs,c=e.name,s=e.pCategoryId,i=e.price,l=this.props.form.getFieldDecorator,u=[];"0"===s?u.push(t):u.push(s,t);var m=r.a.createElement("span",null,r.a.createElement(le,{onClick:this.props.history.goBack},r.a.createElement(v.a,{type:"arrow-left"})),r.a.createElement("span",null,this.update?"\u4fee\u6539\u5546\u54c1\u9875\u9762":"\u6dfb\u52a0\u5546\u54c1\u9875\u9762"));return r.a.createElement(Ee.a,{title:m},r.a.createElement(f.a,{labelCol:{sm:{span:5,offset:1}},wrapperCol:{sm:{span:12}}},r.a.createElement(f.a.Item,{label:"\u5546\u54c1\u540d\u79f0"},l("name",{rules:[{required:!0,message:"\u5546\u54c1\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"}],initialValue:c})(r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}))),r.a.createElement(f.a.Item,{label:"\u5546\u54c1\u63cf\u8ff0"},l("desc",{rules:[{required:!0,message:"\u5546\u54c1\u63cf\u8ff0\u4e0d\u80fd\u4e3a\u7a7a"}],initialValue:a})(r.a.createElement(ze,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u63cf\u8ff0"}))),r.a.createElement(f.a.Item,{label:"\u5546\u54c1\u4ef7\u683c"},l("price",{rules:[{required:!0,message:"\u5546\u54c1\u4ef7\u683c\u4e0d\u80fd\u4e3a\u7a7a"}],initialValue:i})(r.a.createElement(g.a,{type:"number",min:2,placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u4ef7\u683c",addonAfter:"\u5143"}))),r.a.createElement(f.a.Item,{label:"\u5546\u54c1\u5206\u7c7b"},l("category",{rules:[{required:!0,message:"\u4e0d\u80fd\u4e3a\u7a7a"}],initialValue:u})(r.a.createElement(Ae.a,{options:this.state.options,loadData:this.loadData,onChange:this.onChange,changeOnSelect:!0}))),r.a.createElement(f.a.Item,{label:"\u5546\u54c1\u56fe\u7247"},r.a.createElement(Te,{ref:this.imgs,imgs:o})),r.a.createElement(f.a.Item,{label:"\u5546\u54c1\u8be6\u60c5"},r.a.createElement(Ve,{ref:this.details,details:n})),r.a.createElement(f.a.Item,null,r.a.createElement(h.a,{type:"primary",onClick:this.handlesubmit},"\u63d0\u4ea4"))))}}]),t}(n.Component),Je=f.a.create({})(Be),He=Oe.a.Option,Ye=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={products:[],total:0,keywords:"",searchType:"name"},a.columns=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name"},{title:"\u5546\u54c1\u63cf\u8ff0",dataIndex:"desc"},{title:"\u5546\u54c1\u4ef7\u683c",dataIndex:"price",render:function(e){return"\uffe5".concat(e,"\u5143")}},{title:"\u64cd\u4f5c\u7c7b\u578b",width:300,render:function(e){return r.a.createElement("span",null,r.a.createElement(le,{onClick:function(){return a.props.history.push({pathname:"/admin/product/detail",state:{product:e}})}},"\u8be6\u60c5"),r.a.createElement(le,{onClick:function(){return a.props.history.push({pathname:"/admin/product/addUpdate",state:{product:e}})}},"\u4fee\u6539"),r.a.createElement(le,{onClick:function(){return a.removeProduct(e)}},"\u5220\u9664"))}}],a.removeProduct=function(){var e=Object(k.a)(y.a.mark((function e(t){var n,r,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(t);case 2:n=e.sent,r=n.status,o=n.msg,0===r?(E.a.success(o),a.getProducts(1)):E.a.error(o);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getProducts=function(){var e=Object(k.a)(y.a.mark((function e(t){var n,r,o,c,s,i,l,u;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state,r=n.keywords,o=n.searchType,c=null,!r){e.next=8;break}return e.next=5,T(t,Ne,o,r);case 5:c=e.sent,e.next=11;break;case 8:return e.next=10,R(t,Ne);case 10:c=e.sent;case 11:i=(s=c).status,l=s.data,u=s.msg,0===i?(a.setState({products:l.arr,total:l.total}),E.a.success(u)):E.a.error(u);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getProducts(1)}},{key:"render",value:function(){var e=this,t=this.state,a=t.products,n=t.total,o=t.keywords,c=t.searchType,s=r.a.createElement("span",null,r.a.createElement(Oe.a,{value:c,style:{width:200},onChange:function(t){return e.setState({searchType:t})}},r.a.createElement(He,{value:"name"},"\u6309\u540d\u79f0\u641c\u7d22"),r.a.createElement(He,{value:"desc"},"\u6309\u63cf\u8ff0\u641c\u7d22")),r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9",style:{width:200,margin:10},value:o,onChange:function(t){return e.setState({keywords:t.target.value})}}),r.a.createElement(h.a,{type:"primary",onClick:function(){return e.getProducts(1)}},"\u641c\u7d22")),i=r.a.createElement(h.a,{type:"primary",onClick:function(){return e.props.history.push("/admin/product/addUpdate")}},r.a.createElement(v.a,{type:"plus"}),r.a.createElement("span",null,"\u6dfb\u52a0\u5546\u54c1"));return r.a.createElement(Ee.a,{title:s,extra:i},r.a.createElement(ke.a,{dataSource:a,columns:this.columns,rowKey:"_id",bordered:!0,pagination:{total:n,defaultPageSize:Ne,onChange:this.getProducts}}),";")}}]),t}(n.Component),Ge=(a(893),a(332)),Qe=(a(895),Ge.a.Item),Xe=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={name1:"",name2:""},a.getCategory=Object(k.a)(y.a.mark((function e(){var t,n,r,o,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.location.state.product,n=t.categoryId,"0"!==(r=t.pCategoryId)){e.next=8;break}return e.next=4,M(n);case 4:o=e.sent,a.setState({name1:o.data.name}),e.next=12;break;case 8:return e.next=10,Promise.all([M(r),M(n)]);case 10:c=e.sent,a.setState({name1:c[0].data.name,name2:c[1].data.name});case 12:case"end":return e.stop()}}),e)}))),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getCategory()}},{key:"render",value:function(){var e=r.a.createElement("span",null,r.a.createElement(le,{onClick:this.props.history.goBack},r.a.createElement(v.a,{type:"arrow-left"})),r.a.createElement("span",null,"\u5546\u54c1\u8be6\u60c5\u9875\u9762")),t=this.props.location.state.product,a=t.desc,n=t.details,o=t.imgs,c=t.name,s=t.price,i=this.state,l=i.name1,u=i.name2;return r.a.createElement(Ee.a,{title:e},r.a.createElement(Ge.a,{size:"large",bordered:!0},r.a.createElement(Qe,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u540d\u79f0\uff1a"),r.a.createElement("span",{className:"right"},c)),r.a.createElement(Qe,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u63cf\u8ff0\uff1a"),r.a.createElement("span",{className:"right"},a)),r.a.createElement(Qe,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u4ef7\u683c\uff1a"),r.a.createElement("span",{className:"right"},s,"\u5143")),r.a.createElement(Qe,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u5206\u7c7b\uff1a"),r.a.createElement("span",{className:"right"},u?l+"--\x3e"+u:l)),r.a.createElement(Qe,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u56fe\u7247\uff1a"),r.a.createElement("span",{className:"right"},o.map((function(e,t){return r.a.createElement("img",{key:t,className:"product-img",src:Ie+e,alt:""})})))),r.a.createElement(Qe,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u8be6\u60c5\uff1a"),r.a.createElement("span",{dangerouslySetInnerHTML:{__html:n}}))))}}]),t}(n.Component),Ze=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/admin/product/addUpdate",component:Je}),r.a.createElement(d.b,{path:"/admin/product",exact:!0,component:Ye}),r.a.createElement(d.b,{path:"/admin/product/detail",component:Xe})))}}]),t}(n.Component),$e=Oe.a.Option,et=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props,a=t.roles,n=t.user;return n=n||{},r.a.createElement(f.a,{labelCol:{sm:{span:6}},wrapperCol:{sm:{span:12}}},r.a.createElement(f.a.Item,{label:"\u7528\u6237\u540d"},e("username",{rules:[{required:!0,message:"\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a"},{min:3,message:"\u4f60\u592a\u77ed\u4e86"},{max:12,message:"\u592a\u957f\u9876\u4e0d\u4f4f\u4e86!"},{required:!0,message:"\u5b81\u5fc5\u987b\u62e5\u6709\u59d3\u540d"}],initialValue:n.username})(r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\u79f0"}))),r.a.createElement(f.a.Item,{label:"\u5bc6\u7801"},e("password",{rules:[{required:!0,message:"\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a"}],initialValue:n.password})(r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u5bc6\u7801"}))),r.a.createElement(f.a.Item,{label:"\u624b\u673a\u53f7"},e("phone",{rules:[{required:!0,message:"\u624b\u673a\u53f7\u4e0d\u80fd\u4e3a\u7a7a"}],initialValue:n.phone})(r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u624b\u673a\u53f7"}))),r.a.createElement(f.a.Item,{label:"\u89d2\u8272"},e("role_id",{initialValue:n.role_id})(r.a.createElement(Oe.a,null,a.map((function(e){return r.a.createElement($e,{key:e._id,value:e._id},e.name)}))))))}}]),t}(n.Component),tt=f.a.create({})(et),at=ie.a.confirm,nt=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={showvisible:!1,loading:!0,roles:[],users:[],roleName:{}},a.getData=Object(k.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([P(),L()]);case 2:t=e.sent,a.setState({users:t[0].data,roles:t[1].data,loading:!1}),a.initRoles();case 5:case"end":return e.stop()}}),e)}))),a.initRoles=function(){var e=a.state.roles.reduce((function(e,t){return e[t._id]=t.name,e}),{});a.setState({roleName:e})},a.addUser=function(){a.form.props.form.validateFields(function(){var e=Object(k.a)(y.a.mark((function e(t,n){var r,o,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=13;break}if(!a.user){e.next=8;break}return n._id=a.user._id,e.next=5,B(n);case 5:r=e.sent,e.next=11;break;case 8:return e.next=10,F(n);case 10:r=e.sent;case 11:c=(o=r).msg,0===o.status?(a.getData(),E.a.success(c),a.form.props.form.resetFields(),a.setState({showvisible:!1})):E.a.error(c);case 13:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.showUpdate=function(e){console.log(e),a.user=e,a.setState({showvisible:!0})},a.showDeleteConfirm=function(e){at({title:"\u4f60\u786e\u5b9a\u8981\u5220\u9664\u7528\u6237\u5417?",content:"\u5220\u4e86\u65e0\u6cd5\u6062\u590d\u7684\u54e6",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var t=Object(k.a)(y.a.mark((function t(){var n,r,o;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Q(e);case 2:n=t.sent,console.log(n),r=n.status,o=n.msg,0===r?(a.setState({loading:!0}),a.getData(),E.a.success(o)):E.a.error(o);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),onCancel:function(){console.log("Cancel")}})},a.handleCancel=function(){a.setState({showvisible:!1})},a.columns=[{title:"\u7528\u6237\u540d",dataIndex:"username"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",render:function(e){return new Date(e).toLocaleString()}},{title:"\u624b\u673a\u53f7",dataIndex:"phone"},{title:"\u6240\u5c5e\u89d2\u8272",dataIndex:"role_id",render:function(e){return a.state.roleName[e]}},{title:"\u64cd\u4f5c",width:300,render:function(e){return r.a.createElement("span",null,r.a.createElement(le,{onClick:function(){return a.showUpdate(e)}},"\u4fee\u6539\u7528\u6237"),r.a.createElement(le,{onClick:function(){return a.showDeleteConfirm(e)}},"\u5220\u9664\u7528\u6237"))}}],a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.getData()}},{key:"render",value:function(){var e=this,t=this.state,a=t.roles,n=t.users,o=t.loading,c=r.a.createElement("span",null,r.a.createElement(h.a,{type:"primary",icon:"plus",onClick:function(){e.setState({showvisible:!0})}},"\u6dfb\u52a0\u7528\u6237"));return r.a.createElement(Ee.a,{title:c},r.a.createElement(ke.a,{dataSource:n,columns:this.columns,rowKey:"_id",loading:o,bordered:!0,pagination:{defaultPageSize:Ne}}),r.a.createElement(ie.a,{title:this.user?"\u8bf7\u4fee\u6539\u7528\u6237":"\u8bf7\u6dfb\u52a0\u7528\u6237",visible:this.state.showvisible,onOk:this.addUser,onCancel:this.handleCancel},r.a.createElement(tt,{wrappedComponentRef:function(t){return e.form=t},roles:a,user:this.user})))}}]),t}(n.Component),rt=(a(896),a(330)),ot=rt.a.TreeNode,ct=f.a.Item,st=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={checkedKeys:a.props.role.menus},a.getTreeNodes=function(e){return e.reduce((function(e,t){return t.children?e.push(r.a.createElement(ot,{title:t.title,key:t.key},a.getTreeNodes(t.children))):e.push(r.a.createElement(ot,{title:t.title,key:t.key})),e}),[])},a.onCheck=function(e,t){a.setState({checkedKeys:e})},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.treeNodes=this.getTreeNodes(ne)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.role.menus;this.setState({checkedKeys:t})}},{key:"render",value:function(){var e=this.props.role;return r.a.createElement(f.a,{title:"\u89d2\u8272\u540d\u79f0"},r.a.createElement(ct,null,r.a.createElement(g.a,{disabled:!0,placeholder:e.name}),r.a.createElement(rt.a,{checkable:!0,defaultExpandAll:!0,checkedKeys:this.state.checkedKeys,onCheck:this.onCheck},this.treeNodes)))}}]),t}(n.Component),it=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={addvisible:!1,loading:!0,roles:[],role:[],selectedRowKeys:[],showUpdate:!1},a.columns=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",render:function(e){return new Date(e).toLocaleString()}},{title:"\u6388\u6743\u65f6\u95f4",dataIndex:"auth_time",render:function(e){return new Date(e).toLocaleString()}},{title:"\u6388\u6743\u4eba",dataIndex:"auth_name"}],a.getRoles=Object(k.a)(y.a.mark((function e(){var t,n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:t=e.sent,console.log(t),n=t.data,r=t.msg,0===t.status&&(a.setState({loading:!1,roles:n}),E.a.success(r));case 6:case"end":return e.stop()}}),e)}))),a.addRole=function(e){a.form.props.form.validateFields(function(){var e=Object(k.a)(y.a.mark((function e(t,n){var r,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=7;break}return a.setState({loading:!0}),e.next=4,A(n);case 4:r=e.sent,o=r.msg,0===r.status?(a.getRoles(),E.a.success(o),a.setState({addvisible:!1})):E.a.error(o);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.updateRole=Object(k.a)(y.a.mark((function e(){var t,n,r,o,c,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.role,n=Z.getUser(),t.auth_time=new Date,t.menus=a.menus.current.state.checkedKeys,t.auth_name=n.username,console.log(n,t),e.next=8,z(t);case 8:r=e.sent,o=r.status,c=r.msg,s=r.data,n.role_id===t._id?(E.a.success("\u767b\u5f55\u7528\u6237\u7684\u6743\u9650\u5df2\u7ecf\u4fee\u6539"),Z.removeUser(),a.props.history.replace("/login")):0===o?(E.a.success(c),a.setState({showUpdate:!1}),a.getRoles()):(E.a.error(c),console.log(s));case 11:case"end":return e.stop()}}),e)}))),a.removeRole=Object(k.a)(y.a.mark((function e(){var t,n,r,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.selectedRowKeys,e.next=3,G(t);case 3:n=e.sent,r=n.status,o=n.msg,0===r?(a.getRoles(),E.a.success(o)):E.a.error(o);case 6:case"end":return e.stop()}}),e)}))),a.onRow=function(e){return{onClick:function(){a.setState({selectedRowKeys:e._id,role:e}),console.log(a.state.role)}}},a.handleCancel=function(){a.setState({addvisible:!1,showUpdate:!1})},a.menus=r.a.createRef(),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.getRoles()}},{key:"render",value:function(){var e=this,t=this.state,a=t.roles,n=t.loading,o=t.selectedRowKeys,c=t.role,s=r.a.createElement("span",null,r.a.createElement(h.a,{type:"primary",icon:"plus",onClick:function(){e.setState({addvisible:!0})}},"\u6dfb\u52a0\u89d2\u8272"),r.a.createElement(h.a,{type:"primary",style:{margin:10},disabled:!c._id,onClick:function(){e.setState({showUpdate:!0})}},"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650"),r.a.createElement(h.a,{type:"primary",icon:"delete",onClick:this.removeRole},"\u5220\u9664\u89d2\u8272"));return r.a.createElement(Ee.a,{title:s},r.a.createElement(ke.a,{dataSource:a,columns:this.columns,rowKey:"_id",loading:n,bordered:!0,pagination:{defaultPageSize:Ne},rowSelection:{type:"radio",selectedRowKeys:o},onRow:this.onRow}),";",r.a.createElement(ie.a,{title:"\u8bf7\u6dfb\u52a0\u89d2\u8272",visible:this.state.addvisible,onOk:this.addRole,onCancel:this.handleCancel},r.a.createElement(lt,{wrappedComponentRef:function(t){return e.form=t}})),r.a.createElement(ie.a,{title:"\u8bf7\u4fee\u6539\u89d2\u8272",visible:this.state.showUpdate,onOk:this.updateRole,onCancel:this.handleCancel},r.a.createElement(st,{ref:this.menus,role:c})))}}]),t}(n.Component),lt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement(f.a,null,r.a.createElement(f.a.Item,null,e("roleName",{rules:[{required:!0,message:"\u89d2\u8272\u540d\u4e0d\u80fd\u4e3a\u7a7a"}]})(r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"}))))}}]),t}(n.Component);lt=f.a.create()(lt);var ut=a(96),mt=a.n(ut),pt=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={books:[1e3,2e3,1500,3e3,2e3,1200,800],sales:[800,1500,1300,2800,1500,1e3,500]},a.getOption=function(){return{title:{text:"\u67f1\u5f62\u56fe-1",textStyle:{color:"pink"}},legend:{data:["\u5b58\u8d27"],icon:"circle"},tooltip:{trigger:"axis"},xAxis:{data:["\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d","\u5468\u65e5"]},yAxis:{},series:[{name:"\u5b58\u8d27",type:"bar",data:[1e3,2e3,1500,3e3,2e3,1200,800]}]}},a.getOption2=function(e,t){return{title:{text:"\u67f1\u5f62\u56fe-2",textStyle:{color:"pink"}},legend:{data:["\u8ba2\u5355\u91cf","\u9500\u91cf"],icon:"circle"},tooltip:{trigger:"axis"},xAxis:{data:["\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d","\u5468\u65e5"]},yAxis:{},series:[{name:"\u8ba2\u5355\u91cf",type:"bar",data:e},{name:"\u9500\u91cf",type:"bar",data:t}]}},a.updata=function(){a.setState((function(e){return{books:e.books.map((function(e){return e+100})),sales:e.sales.map((function(e){return e-20}))}}))},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=r.a.createElement(h.a,{type:"primary",onClick:this.updata},"\u66f4\u65b0\u6570\u636e"),t=this.state,a=t.books,n=t.sales;return r.a.createElement("div",null,r.a.createElement(Ee.a,null,r.a.createElement(mt.a,{option:this.getOption()})),r.a.createElement(Ee.a,{title:e},r.a.createElement(mt.a,{option:this.getOption2(a,n)})))}}]),t}(n.Component),dt=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={books:[1e3,2e3,1500,3e3,2e3,1200,800],sales:[800,1500,1300,2800,1500,1e3,500]},a.getOption1=function(){return{title:{text:"\u6298\u7ebf\u56fe-1",textStyle:{color:"pink"}},legend:{data:["\u5b58\u8d27"],icon:"circle"},tooltip:{trigger:"axis"},xAxis:{data:["\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d","\u5468\u65e5"]},yAxis:{},series:[{name:"\u5b58\u8d27",type:"line",data:[1e3,2e3,1500,3e3,2e3,1200,800]}]}},a.getOption2=function(e,t){return{title:{text:"\u6298\u7ebf\u56fe-2",textStyle:{color:"pink"}},legend:{data:["\u8ba2\u5355\u91cf","\u9500\u91cf"],icon:"circle"},tooltip:{trigger:"axis"},xAxis:{data:["\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d","\u5468\u65e5"]},yAxis:{},series:[{name:"\u8ba2\u5355\u91cf",type:"line",data:e},{name:"\u9500\u91cf",type:"line",data:t}]}},a.update=function(){a.setState((function(e){return{books:e.books.map((function(e){return e+100})),sales:e.sales.map((function(e){return e-20}))}}))},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=r.a.createElement(h.a,{type:"primary",onClick:this.update},"\u66f4\u65b0\u6570\u636e"),t=this.state,a=t.books,n=t.sales;return r.a.createElement("div",null,r.a.createElement(Ee.a,null,r.a.createElement(mt.a,{option:this.getOption1()})),r.a.createElement(Ee.a,{title:e},r.a.createElement(mt.a,{option:this.getOption2(a,n)})))}}]),t}(n.Component),ht=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).getOption1=function(){return{title:{text:"\u997c\u56fe-1",textStyle:{color:"pink"}},legend:{data:["\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d","\u5468\u65e5"],icon:"circle",orient:"vertical",right:20,top:20},tooltip:{trigger:"item",formatter:"{a}<br/>{b}:{c}({d}%)"},series:[{name:"\u5b58\u8d27",type:"pie",data:[{value:1e3,name:"\u5468\u4e00"},{value:2e3,name:"\u5468\u4e8c"},{value:1500,name:"\u5468\u4e09"},{value:3e3,name:"\u5468\u56db"},{value:1200,name:"\u5468\u4e94"},{value:2e3,name:"\u5468\u516d"},{value:800,name:"\u5468\u65e5"}]}]}},a.getOption2=function(){return{title:{text:"\u997c\u56fe-2",textStyle:{color:"pink"}},legend:{data:["\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d","\u5468\u65e5"],icon:"circle",orient:"vertical",right:20,top:20},tooltip:{trigger:"item",formatter:"{a}<br/>{b}:{c}({d}%)"},series:[{name:"\u5b58\u8d27",type:"pie",roseType:"radius",data:[{value:1e3,name:"\u5468\u4e00"},{value:2e3,name:"\u5468\u4e8c"},{value:1500,name:"\u5468\u4e09"},{value:3e3,name:"\u5468\u56db"},{value:1200,name:"\u5468\u4e94"},{value:2e3,name:"\u5468\u516d"},{value:800,name:"\u5468\u65e5"}].sort((function(e,t){return e.value-t.value}))}]}},a.getOption3=function(){return{title:{text:"\u997c\u56fe-3",textStyle:{color:"pink"}},legend:{data:["\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d","\u5468\u65e5"],icon:"circle",orient:"vertical",right:20,top:20},tooltip:{trigger:"item",formatter:"{a}<br/>{b}:{c}({d}%)"},series:[{name:"\u5b58\u8d27",type:"pie",radius:["50%","70%"],data:[{value:1e3,name:"\u5468\u4e00"},{value:2e3,name:"\u5468\u4e8c"},{value:1500,name:"\u5468\u4e09"},{value:3e3,name:"\u5468\u56db"},{value:1200,name:"\u5468\u4e94"},{value:2e3,name:"\u5468\u516d"},{value:800,name:"\u5468\u65e5"}]}]}},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Ee.a,null,r.a.createElement(mt.a,{option:this.getOption1()})),r.a.createElement(Ee.a,null,r.a.createElement(mt.a,{option:this.getOption2()})),r.a.createElement(Ee.a,null,r.a.createElement(mt.a,{option:this.getOption3()})))}}]),t}(n.Component),ft=te.a.Footer,gt=te.a.Content,vt=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={collapsed:!1},a.onCollapse=function(e){a.setState({collapsed:e})},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){}},{key:"render",value:function(){var e=Z.getUser();return console.log(document.body.offsetHeight,123456),e._id?r.a.createElement(te.a,{style:{height:"100%"}},r.a.createElement(se,null),r.a.createElement(te.a,null,r.a.createElement(pe,null),r.a.createElement(gt,null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/admin/home",component:ye}),r.a.createElement(d.b,{path:"/admin/category",component:_e}),r.a.createElement(d.b,{path:"/admin/product",component:Ze}),r.a.createElement(d.b,{path:"/admin/user",component:nt}),r.a.createElement(d.b,{path:"/admin/role",component:it}),r.a.createElement(d.b,{path:"/admin/charts/bar",component:pt}),r.a.createElement(d.b,{path:"/admin/charts/line",component:dt}),r.a.createElement(d.b,{path:"/admin/charts/pie",component:ht}))),r.a.createElement(ft,{style:{textAlign:"center",bottom:"0px"}},"\u738b\u6d3d\u80a5 \u5907\u6848/\u8bb8\u53ef\u8bc1\u7f16\u53f7\u4e3a\uff1a\u82cfICP\u590719073597\u53f7  2019-12-19"))):r.a.createElement(d.a,{to:"/login"})}}]),t}(n.Component),bt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/login",component:ee}),r.a.createElement(d.b,{path:"/admin",component:vt}),r.a.createElement(d.a,{path:!0,to:"/login"})))}}]),t}(n.Component);c.a.render(r.a.createElement(bt,null),document.getElementById("box"))},527:function(e,t,a){e.exports=a(1202)},599:function(e,t,a){},692:function(e,t,a){},693:function(e,t,a){},694:function(e,t,a){},708:function(e,t,a){},895:function(e,t,a){}},[[527,1,2]]]);
//# sourceMappingURL=main.59aa7d1c.chunk.js.map